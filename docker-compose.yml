services:
  demo-app:
    build:
      context: .
      dockerfile: docker/demo-app/Dockerfile
    ports:
      - "${DEMO_APP_PORT:-13003}:5173"
    volumes:
      - .:/app
      - demo_node_modules:/app/node_modules
      - demo_tokens_modules:/app/packages/tokens/node_modules
      - demo_ui_modules:/app/packages/ui/node_modules
      - demo_app_modules:/app/apps/demo-app/node_modules
      - demo_storybook_modules:/app/apps/storybook/node_modules
    environment:
      - NODE_ENV=development
    tty: true

  storybook:
    build:
      context: .
      dockerfile: docker/storybook/Dockerfile
    ports:
      - "${STORYBOOK_PORT:-13004}:6006"
    volumes:
      - .:/app
      - sb_node_modules:/app/node_modules
      - sb_tokens_modules:/app/packages/tokens/node_modules
      - sb_ui_modules:/app/packages/ui/node_modules
      - sb_app_modules:/app/apps/demo-app/node_modules
      - sb_storybook_modules:/app/apps/storybook/node_modules
    environment:
      - NODE_ENV=development
      - BROWSER=none
      - CI=true
    tty: true

volumes:
  demo_node_modules:
  demo_tokens_modules:
  demo_ui_modules:
  demo_app_modules:
  demo_storybook_modules:
  sb_node_modules:
  sb_tokens_modules:
  sb_ui_modules:
  sb_app_modules:
  sb_storybook_modules:
